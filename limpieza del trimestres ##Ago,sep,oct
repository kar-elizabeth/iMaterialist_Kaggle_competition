import pandas as pd
import unicodedata

# Cargar archivo (reemplaza por tu ruta o súbelo a Colab)
df = pd.read_excel('datos_homologados CON DIV HOMOLOGADA.xlsx')

# Función para homologar texto
def limpiar_texto(texto):
    if pd.isnull(texto):
        return texto
    # Convertir a mayúsculas
    texto = str(texto).upper()
    # Quitar acentos
    texto = ''.join(
        c for c in unicodedata.normalize('NFD', texto)
        if unicodedata.category(c) != 'Mn'
    )
    # Eliminar espacios de más
    texto = ' '.join(texto.split())
    return texto

# Aplica limpieza a TODAS las columnas tipo texto
for col in df.select_dtypes(include=['object']).columns:
    df[col] = df[col].apply(limpiar_texto)

# Guardar resultado
df.to_excel('/content/datos_homologados.xlsx', index=False)

print("✅ Listo. Archivo generado: datos_homologados.xlsx")
